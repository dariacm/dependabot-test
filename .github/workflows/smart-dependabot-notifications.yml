name: Smart Dependabot Notifications

on:
  workflow_run:
    workflows: ['Ensure labels', 'ci']  # This matches the workflow name in packages.ensure-labels.yml and ci.yml
    types:
      - completed

jobs:
  notify-on-failure:
    runs-on: ubuntu-latest
    permissions:
      pull-requests: write
      actions: read
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Add reviewers on failure
        uses: ./.github/actions/smart-dependabot-notifications
        with:
          github-token: ${{ github.token }}
          reviewers: 'dariacm'
          team-reviewers: ''
          comment: 'Testing GitHub actions, please ignore me'
